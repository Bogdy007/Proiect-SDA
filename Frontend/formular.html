<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formular Articol</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
</head>
<body>

    <header>
        <h1><i class="fa-solid fa-desktop"></i> Evidență Echipamente IT</h1>
    </header>

    <main class="container">

        <div class="page-actions">
            <h2 id="form-title">...</h2>
            <a href="select_type.html" class="btn" style="background-color: var(--secondary-color);"><i class="fa-solid fa-arrow-left"></i> Schimbă Tipul</a>
        </div>

        <div class="form-container" id="form-echipament-container" style="display: none;">
            <form id="form-echipament">
                <input type="hidden" name="CATEGORIE" value="Echipament IT">
                <h3><i class="fa-solid fa-laptop-code"></i> Date Echipament IT</h3>

                <div class="detalii-grid">
                    <div class="form-group"><label for="echip-nr-inventar">Nr. Inventar</label><input type="text" id="echip-nr-inventar" name="NR_INVENTAR" required></div>
                    <div class="form-group"><label for="echip-tip-calc">Tip Echipament (PC/Laptop)</label><input type="text" id="echip-tip-calc" name="TIP_CALC"></div>
                    <div class="form-group"><label for="echip-nume-pc">Nume PC</label><input type="text" id="echip-nume-pc" name="NUME_PC"></div>
                    <div class="form-group"><label for="echip-utilizator">Utilizator</label><input type="text" id="echip-utilizator" name="UTILIZATOR"></div>
                    <div class="form-group"><label for="echip-nr-user">Nr. User</label><input type="text" id="echip-nr-user" name="NR_USER"></div>
                    <div class="form-group"><label for="echip-data-achizitie">Data Achiziție</label><input type="date" id="echip-data-achizitie" name="DATA_ACHIZITIE"></div>
                    <div class="form-group"><label for="echip-etaj">Etaj</label><input type="text" id="echip-etaj" name="ETAJ"></div>
                    <div class="form-group"><label for="echip-functie">Funcție</label><input type="text" id="echip-functie" name="FUNCTIE"></div>
                    <div class="form-group"><label for="echip-ip">Adresă IP</label><input type="text" id="echip-ip" name="IP"></div>
                    <div class="form-group"><label for="echip-retea">Retea</label><input type="text" id="echip-retea" name="RETEA"></div>
                    <div class="form-group"><label for="echip-serie-uc">Serie UC</label><input type="text" id="echip-serie-uc" name="SERIE_UC"></div>
                    <div class="form-group"><label for="echip-serie-mon">Serie Monitor</label><input type="text" id="echip-serie-mon" name="SERIE_MON"></div>
                    <div class="form-group"><label for="echip-memorie">Memorie</label><input type="text" id="echip-memorie" name="MEMORIE"></div>
                    <div class="form-group"><label for="echip-sistem-operare">Sistem Operare</label><input type="text" id="echip-sistem-operare" name="SISTEM_OPERARE"></div>
                    <div class="form-group"><label for="echip-licenta-so">Licență SO</label><input type="text" id="echip-licenta-so" name="LICENTA_SO"></div>
                    <div class="form-group"><label for="echip-office">Office</label><input type="text" id="echip-office" name="OFFICE"></div>
                    <div class="form-group"><label for="echip-licenta-office">Licență Office</label><input type="text" id="echip-licenta-office" name="LICENTA_OFFICE"></div>
                    <div class="form-group"><label for="echip-antivirus">Antivirus</label><input type="text" id="echip-antivirus" name="ANTIVIRUS"></div>
                    <div class="form-group"><label for="echip-camera">Cameră</label><input type="text" id="echip-camera" name="CAMERA"></div>
                    <div class="form-group"><label for="echip-telefon">Telefon</label><input type="text" id="echip-telefon" name="TELEFON"></div>
                    <div class="form-group"><label for="echip-parchet">Parchet</label><input type="text" id="echip-parchet" name="PARCHET"></div>
                    <div class="form-group"><label for="echip-pass">Pass</label><input type="text" id="echip-pass" name="PASS"></div>
                </div>
                <div class="form-group"><label for="echip-periferice">Periferice Atasate</label><textarea id="echip-periferice" name="PERIFERICE" rows="3"></textarea></div>
                <div class="form-group"><label for="echip-obs">Observații</label><textarea id="echip-obs" name="OBS" rows="3"></textarea></div>

                <div class="form-actions">
                    <button type="button" class="btn btn-cancel" style="background-color: var(--secondary-color);"><i class="fa-solid fa-xmark"></i> Anulează</button>
                    <button type="submit" class="btn"><i class="fa-solid fa-save"></i> Salvează Echipament</button>
                </div>
            </form>
        </div>

        <div class="form-container" id="form-periferic-container" style="display: none;">
            <form id="form-periferic">
                <input type="hidden" name="CATEGORIE" value="Periferic">
                <h3><i class="fa-solid fa-print"></i> Date Periferic</h3>

                <div class="detalii-grid">
                    <div class="form-group"><label for="perif-nr-inventar">Nr. Inventar</label><input type="text" id="perif-nr-inventar" name="NR_INVENTAR" required></div>
                    <div class="form-group"><label for="perif-tip">Tip (Imprimantă/Scanner)</label><input type="text" id="perif-tip" name="TIP"></div>
                    <div class="form-group"><label for="perif-producator">Producător</label><input type="text" id="perif-producator" name="PRODUCATOR"></div>
                    <div class="form-group"><label for="perif-nume-periferice">Nume Periferic</label><input type="text" id="perif-nume-periferice" name="NUME_PERIFERICE"></div>
                    <div class="form-group"><label for="perif-utilizator">Utilizator</label><input type="text" id="perif-utilizator" name="UTILIZATOR"></div>
                    <div class="form-group"><label for="perif-nume-user">Nume User</label><input type="text" id="perif-nume-user" name="NUME_USER"></div>
                    <div class="form-group"><label for="perif-data-achizitie">Data Achiziție</label><input type="date" id="perif-data-achizitie" name="DATA_ACHIZITIE"></div>
                    <div class="form-group"><label for="perif-nume-calc">Nume Calculator Conectat</label><input type="text" id="perif-nume-calc" name="NUME_CALC"></div>
                    <div class="form-group"><label for="perif-serie-uc">Serie UC Conectată</label><input type="text" id="perif-serie-uc" name="SERIE_UC"></div>
                    <div class="form-group"><label for="perif-ip">Adresă IP</label><input type="text" id="perif-ip" name="IP"></div>
                    <div class="form-group"><label for="perif-retea">Retea</label><input type="text" id="perif-retea" name="RETEA"></div>
                    <div class="form-group"><label for="perif-memorie">Memorie</label><input type="text" id="perif-memorie" name="MEMORIE"></div>
                    <div class="form-group"><label for="perif-format">Format (A4/A3)</label><input type="text" id="perif-format" name="FORMAT"></div>
                    <div class="form-group"><label for="perif-culoare-imprimare">Culoare Imprimare</label><input type="text" id="perif-culoare-imprimare" name="CULOARE_IMPRIMARE"></div>
                    <div class="form-group"><label for="perif-duplex">Duplex</label><input type="text" id="perif-duplex" name="DUPLEX"></div>
                    <div class="form-group"><label for="perif-stare-parametri">Stare Parametri</label><input type="text" id="perif-stare-parametri" name="STARE_PARAMETRI"></div>
                    <div class="form-group"><label for="perif-camera">Cameră</label><input type="text" id="perif-camera" name="CAMERA"></div>
                    <div class="form-group"><label for="perif-antivirus">Antivirus</label><input type="text" id="perif-antivirus" name="ANTIVIRUS"></div>
                    <div class="form-group"><label for="perif-parchet">Parchet</label><input type="text" id="perif-parchet" name="PARCHET"></div>
                    <div class="form-group"><label for="perif-pass">Pass</label><input type="text" id="perif-pass" name="PASS"></div>
                </div>
                <div class="form-group"><label for="perif-obs">Observații</label><textarea id="perif-obs" name="OBS" rows="3"></textarea></div>
                <div class="form-group"><label for="perif-obs2">Observații 2</label><textarea id="perif-obs2" name="OBS2" rows="3"></textarea></div>

                <div class="form-actions">
                    <button type="button" class="btn btn-cancel" style="background-color: var(--secondary-color);"><i class="fa-solid fa-xmark"></i> Anulează</button>
                    <button type="submit" class="btn"><i class="fa-solid fa-save"></i> Salvează Periferic</button>
                </div>
            </form>
        </div>
    </main>

    <footer class="app-footer">
        <p>© 2025 Parchetul de pe lângă Tribunalul Brașov. Toate drepturile rezervate. Aplicație internă de inventariere.</p>
    </footer>

    <script>
        const API_ECHIPAMENTE_URL = 'http://127.0.0.1:5000/api/echipamente/add';
        const API_PERIFERICE_URL = 'http://127.0.0.1:5000/api/periferice/add';

        document.addEventListener('DOMContentLoaded', () => {
            const params = new URLSearchParams(window.location.search);
            const type = params.get('type');

            const formTitle = document.getElementById('form-title');
            const formEchipament = document.getElementById('form-echipament-container');
            const formPeriferic = document.getElementById('form-periferic-container');

            if (type === 'echipament') {
                formTitle.innerHTML = '<i class="fa-solid fa-plus-circle"></i> Adaugă Echipament IT Nou';
                formEchipament.style.display = 'block';
                formPeriferic.style.display = 'none';
            } else if (type === 'periferic') {
                formTitle.innerHTML = '<i class="fa-solid fa-plus-circle"></i> Adaugă Periferic Nou';
                formEchipament.style.display = 'none';
                formPeriferic.style.display = 'block';
            } else {
                window.location.href = 'select_type.html';
            }

            document.querySelectorAll('.btn-cancel').forEach(btn => {
                btn.addEventListener('click', () => window.location.href = 'index.html');
            });

            document.getElementById('form-echipament').addEventListener('submit', function(e) {
                e.preventDefault();
                trimiteFormular(this, API_ECHIPAMENTE_URL);
            });

            document.getElementById('form-periferic').addEventListener('submit', function(e) {
                e.preventDefault();
                trimiteFormular(this, API_PERIFERICE_URL);
            });
        });

        function trimiteFormular(formElement, url) {
            const formData = new FormData(formElement);
            const dataObject = Object.fromEntries(formData.entries());

            fetch(url, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(dataObject)
            })
            .then(response => response.json())
            .then(data => {
                if (data.succes) {
                    alert(data.mesaj || 'Articol adăugat cu succes!');
                    window.location.href = 'index.html';
                } else {
                    alert('Eroare la salvare: ' + (data.eroare || 'Verificați Nr. de Inventar (nu trebuie să se repete).'));
                }
            })
            .catch(error => {
                console.error('Eroare de rețea:', error);
                alert('Eroare de rețea. Asigură-te că serverul "main.py" rulează.');
            });
        }
    </script>

</body>
</html>